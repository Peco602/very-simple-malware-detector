"""Test training module"""

import train


def test_read_dataset():
    """Test read_dataset function"""
    df = train.read_dataset(path=train.DATASET_PATH)
    assert len(df) > 0


class TestModel1:
    """Test model 1"""


class TestModel2:
    """Test model 2"""


def test_get_best_model():
    """Test get_best_model function"""
    MODEL_SEARCH_SPACE = [
        {
            "model": TestModel1,
            "best_params": {
                "param_1": 2,
                "param_2": 10,
            },
            "best_score": 0.96,
        },
        {
            "model": TestModel2,
            "best_params": {
                "param_1": 1,
                "param_2": 0,
                "param_3": 5,
            },
            "best_score": 0.99,
        },
    ]

    best_model, best_params = train.get_best_model(search_space=MODEL_SEARCH_SPACE)

    assert best_model == TestModel2
    assert best_params == {"param_1": 1, "param_2": 0, "param_3": 5}
