"""Streamlit app module"""

import streamlit as st

import predict

TITLE = "Very Simple Malware Detector"
MALWARE_STYLE = "padding: 20px; background-color: #f44336; color: white; margin-bottom: 15px; text-align: center; text-style: bold; font-size: 24px;"
BENIGN_STYLE = "padding: 20px; background-color: #4cbb17; color: white; margin-bottom: 15px; text-align: center; text-style: bold; font-size: 24px;"
ERROR_STYLE = "padding: 20px; background-color: #ffc300; color: white; margin-bottom: 15px; text-align: center; text-style: bold; font-size: 24px;"


def print_outcome(outcome):
    """Outcome printing function"""
    if outcome == "Malware":
        st.write(f'<div style="{MALWARE_STYLE}">{outcome}</div>', unsafe_allow_html=True)
    else:
        st.write(f'<div style="{BENIGN_STYLE}">{outcome}</div>', unsafe_allow_html=True)


def print_error(error):
    """Error print function"""
    st.write(f'<div style="{ERROR_STYLE}">Error: {error}</div>', unsafe_allow_html=True)


def main():
    """Main function"""
    st.set_page_config(page_title=TITLE)
    st.title(TITLE)

    uploaded_file = st.file_uploader("Upload a file to be analyzed")
    if uploaded_file is not None:
        bytes_data = uploaded_file.getvalue()
        sample_imports = predict.get_sample_imports(bytes_data)

        if isinstance(sample_imports, list):
            sample_outcome = predict.predict(sample_imports)
            outcome = predict.convert_sample_outcome(sample_outcome)
            print_outcome(outcome)
        else:
            print_error(sample_imports)


if __name__ == '__main__':
    main()
